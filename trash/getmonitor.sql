SELECT U.id as `ID`, U.nickname as `Nickname`, U.city as `city`, U.studyplace as `studyplace, `sum(if(S.resultid=0,1,0)) as `Solved`, sum(S.penalty) as `Penalty` , max(if(S.problemID='A',if(S.resultid=0,20000+attempt,10000+attempt),0)) as `A` , max(if(S.problemID='B',if(S.resultid=0,20000+attempt,10000+attempt),0)) as `B` , max(if(S.problemID='C',if(S.resultid=0,20000+attempt,10000+attempt),0)) as `C` , max(if(S.problemID='D',if(S.resultid=0,20000+attempt,10000+attempt),0)) as `D` , max(if(S.problemID='E',if(S.resultid=0,20000+attempt,10000+attempt),0)) as `E` , max(if(S.problemID='F',if(S.resultid=0,20000+attempt,10000+attempt),0)) as `F` , max(if(S.problemID='G',if(S.resultid=0,20000+attempt,10000+attempt),0)) as `G` , max(if(S.problemID='H',if(S.resultid=0,20000+attempt,10000+attempt),0)) as `H` , max(if(S.problemID='I',if(S.resultid=0,20000+attempt,10000+attempt),0)) as `I` , max(if(S.problemID='J',if(S.resultid=0,20000+attempt,10000+attempt),0)) as `J` , max(if(S.problemID='K',if(S.resultid=0,20000+attempt,10000+attempt),0)) as `K` , max(if(S.problemID='L',if(S.resultid=0,20000+attempt,10000+attempt),0)) as `L` , max(if(S.problemID='M',if(S.resultid=0,20000+attempt,10000+attempt),0)) as `M` , max(if(S.problemID='N',if(S.resultid=0,20000+attempt,10000+attempt),0)) as `N` , max(if(S.problemID='O',if(S.resultid=0,20000+attempt,10000+attempt),0)) as `O` , max(if(S.problemID='P',if(S.resultid=0,20000+attempt,10000+attempt),0)) as `P` FROM `User` U INNER JOIN `Submit` S ON U.ID=S.UserID WHERE S.ContestID = 1 and S.isTaskSolved = 0 GROUP BY U.ID ORDER BY `Solved` DESC, `Penalty` ASC, U.id asc